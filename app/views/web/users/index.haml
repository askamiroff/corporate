%h1.page-header= t :users

%table.table.table-striped
  %thead
    %tr
      = readable_tag :th, :user, :avatar do
        = han :user, :avatar
      = readable_tag :th, :user, :name do
        = sort_link @q, :name
      = readable_tag :th, :user, :email do
        = sort_link @q, :email
      = readable_tag :th, :user, :role do
        = sort_link @q, :role
      %th= t :operations
  %tbody
    - @users.each do |user|
      %tr
        - present user do |user_presenter|
          = readable_tag :td, :user, :avatar do
            = user_presenter.avatar_thumb
          = readable_tag :td, :user, :name do
            = user_presenter.name
          = readable_tag :td, :user, :email do
            = user_presenter.email
          = readable_tag :td, :user, :role do
            = user_presenter.role_text
        %td
          - if policy(user).statistics_show?
            = link_to t(:statistics), user_statistics_path(user)
          - if policy(user).edit?
            = link_to t(:edit), edit_user_path(user)
          - if policy(:session).update?
            = link_to t(:switch_user), session_path(session: { user_id: user.id }), method: :patch

        = paginate @users, theme: 'twitter-bootstrap-3'
